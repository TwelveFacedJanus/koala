\doxysection{Логгер Ant\+Logger}
\hypertarget{group___ant_logger}{}\label{group___ant_logger}\index{Логгер AntLogger@{Логгер AntLogger}}


Многофункциональный потокобезопасный логгер с поддержкой асинхронности, модулей и цветного вывода.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_ant_log_async_msg}{Ant\+Log\+Async\+Msg}}
\begin{DoxyCompactList}\small\item\em Структура для передачи лог-\/сообщения в event loop. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{group___ant_logger_ga221ad35833a5d41f71421f2f3c066c95}{ant\+\_\+log\+\_\+enable\+\_\+colors}} (bool enable)
\begin{DoxyCompactList}\small\item\em Включить или отключить цветной вывод. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___ant_logger_ga1f76a3ecf536cfb2681828f6b8941835}{ant\+\_\+log\+\_\+enable\+\_\+async}} (bool enable)
\begin{DoxyCompactList}\small\item\em Включить или отключить асинхронный режим логирования. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___ant_logger_gaa2cfe4fcc129fa9b0766b9779db64858}{ant\+\_\+log\+\_\+init}} (const char \texorpdfstring{$\ast$}{*}file\+\_\+path)
\begin{DoxyCompactList}\small\item\em Инициализация логгера. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___ant_logger_ga0d13b320d5c91e58632c230243f00bb8}{ant\+\_\+log\+\_\+shutdown}} ()
\begin{DoxyCompactList}\small\item\em Завершение работы логгера, освобождение ресурсов. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___ant_logger_gabc2800dfb26fd0b291ea7e04520328ec}{ant\+\_\+log\+\_\+set\+\_\+level}} (\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}} level)
\begin{DoxyCompactList}\small\item\em Установить минимальный уровень логирования. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___ant_logger_ga9a61caaff7630aa717988962a55b3452}{ant\+\_\+log\+\_\+set\+\_\+callback}} (\mbox{\hyperlink{ant__logger_8h_a7bc4329f01da48b7bb263197d1d3e440}{ant\+\_\+log\+\_\+callback\+\_\+t}} cb)
\begin{DoxyCompactList}\small\item\em Установить пользовательский callback для логирования. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{group___ant_logger_gabc00b5c23fd4d11163bb01ea559322c4}{ant\+\_\+log\+\_\+output}} (\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}} level, const char \texorpdfstring{$\ast$}{*}module, const char \texorpdfstring{$\ast$}{*}msg)
\begin{DoxyCompactList}\small\item\em Вывод сообщения (thread-\/safe) \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{group___ant_logger_ga1ab70f322f8077796d3fd3fce804d789}{ant\+\_\+log\+\_\+format}} (char \texorpdfstring{$\ast$}{*}out, size\+\_\+t out\+\_\+sz, \mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}} level, const char \texorpdfstring{$\ast$}{*}module, const char \texorpdfstring{$\ast$}{*}file, int line, const char \texorpdfstring{$\ast$}{*}func, const char \texorpdfstring{$\ast$}{*}msg)
\begin{DoxyCompactList}\small\item\em Форматирование сообщения с цветом, временем и контекстом. \end{DoxyCompactList}\item 
static \mbox{\hyperlink{struct_result}{Result}} \mbox{\hyperlink{group___ant_logger_ga88512267049455a44ecba369aa21dfa4}{ant\+\_\+log\+\_\+async\+\_\+func}} (\mbox{\hyperlink{struct_function_params}{Function\+Params}} \texorpdfstring{$\ast$}{*}params)
\begin{DoxyCompactList}\small\item\em Функция-\/обёртка для асинхронного вывода логов через event loop. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___ant_logger_ga0aa4315bcae65fafb912aa5319c64417}{ant\+\_\+log\+\_\+write}} (\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}} level, const char \texorpdfstring{$\ast$}{*}module, const char \texorpdfstring{$\ast$}{*}file, int line, const char \texorpdfstring{$\ast$}{*}func, const char \texorpdfstring{$\ast$}{*}fmt,...)
\begin{DoxyCompactList}\small\item\em Основная функция логирования (используйте макросы). \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static FILE \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\+\_\+file}} = NULL
\begin{DoxyCompactList}\small\item\em Файл для логирования (NULL = stderr) \end{DoxyCompactList}\item 
static \mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}} \mbox{\hyperlink{group___ant_logger_gac2d0c8bd84c184f09bc7bd777bfcc96a}{min\+\_\+level}} = \mbox{\hyperlink{ant__logger_8h_a2b59d76f88b5231b3ac08e423a952b86}{ANT\+\_\+\+LOG\+\_\+\+DEBUG}}
\begin{DoxyCompactList}\small\item\em Минимальный уровень логирования \end{DoxyCompactList}\item 
static \mbox{\hyperlink{ant__logger_8h_a7bc4329f01da48b7bb263197d1d3e440}{ant\+\_\+log\+\_\+callback\+\_\+t}} \mbox{\hyperlink{group___ant_logger_gadda969f63c963605bba1b88d35ca66f6}{user\+\_\+callback}} = NULL
\begin{DoxyCompactList}\small\item\em Пользовательский callback для логирования \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{group___ant_logger_ga7d98e2dd1964a2c9cdb897cc63f23d0b}{use\+\_\+colors}} = 1
\begin{DoxyCompactList}\small\item\em Включён ли цветной вывод \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\+\_\+async}} = 0
\begin{DoxyCompactList}\small\item\em Включён ли асинхронный режим \end{DoxyCompactList}\item 
static \mbox{\hyperlink{struct_async_event_loop}{Async\+Event\+Loop}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\+\_\+loop}} = NULL
\begin{DoxyCompactList}\small\item\em Event loop для асинхронного логирования \end{DoxyCompactList}\item 
static pthread\+\_\+mutex\+\_\+t \mbox{\hyperlink{group___ant_logger_ga54baead9ac1aa7d2d2f886956ac57c1e}{log\+\_\+mutex}} = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER
\begin{DoxyCompactList}\small\item\em Мьютекс для потокобезопасности \end{DoxyCompactList}\item 
static const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{group___ant_logger_ga8a2ced25981b49f1555d16f390df6006}{level\+\_\+colors}} \mbox{[}$\,$\mbox{]}
\item 
static const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{group___ant_logger_ga6ee99f12766d97f932da55d2232f5cf5}{level\+\_\+names}} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Многофункциональный потокобезопасный логгер с поддержкой асинхронности, модулей и цветного вывода. 



\doxysubsection{Function Documentation}
\Hypertarget{group___ant_logger_ga88512267049455a44ecba369aa21dfa4}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_async\_func@{ant\_log\_async\_func}}
\index{ant\_log\_async\_func@{ant\_log\_async\_func}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_async\_func()}{ant\_log\_async\_func()}}
{\footnotesize\ttfamily \label{group___ant_logger_ga88512267049455a44ecba369aa21dfa4} 
static \mbox{\hyperlink{struct_result}{Result}} ant\+\_\+log\+\_\+async\+\_\+func (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_function_params}{Function\+Params}} \texorpdfstring{$\ast$}{*}}]{params}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Функция-\/обёртка для асинхронного вывода логов через event loop. 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00174}{174}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keywordflow}{if}\ (!params\ ||\ !params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}}\ ||\ params-\/>\mbox{\hyperlink{struct_function_params_abec2b9a3d56da4074bd803c48dadba8e}{argc}}\ <\ 1)\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Invalid\ async\ log\ parameters!\(\backslash\)n"{}});}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{struct_result}{Result}})\{\ .is\_ok\ =\ 0\ \};}
\DoxyCodeLine{00178\ \ \ \ \ \}}
\DoxyCodeLine{00179\ \ \ \ \ \mbox{\hyperlink{struct_ant_log_async_msg}{AntLogAsyncMsg}}*\ logmsg\ =\ (\mbox{\hyperlink{struct_ant_log_async_msg}{AntLogAsyncMsg}}*)params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}}[0].\mbox{\hyperlink{struct_generic_a1fbf56fa903c54bf08b9be9d7a11138e}{value}};}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (!logmsg)\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ NULL\ log\ message\ in\ async!\(\backslash\)n"{}});}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{struct_result}{Result}})\{\ .is\_ok\ =\ 0\ \};}
\DoxyCodeLine{00183\ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{group___ant_logger_gabc00b5c23fd4d11163bb01ea559322c4}{ant\_log\_output}}(logmsg-\/>level,\ logmsg-\/>module,\ logmsg-\/>message);}
\DoxyCodeLine{00185\ \ \ \ \ free(logmsg);}
\DoxyCodeLine{00186\ \ \ \ \ free(params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}});}
\DoxyCodeLine{00187\ \ \ \ \ free(params);}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{struct_result}{Result}})\{\ .is\_ok\ =\ 1\ \};}
\DoxyCodeLine{00189\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00136}{ant\+\_\+log\+\_\+output()}}, \mbox{\hyperlink{types_8h_source_l00210}{Function\+Params\+::argc}}, \mbox{\hyperlink{types_8h_source_l00211}{Function\+Params\+::argv}}, \mbox{\hyperlink{ant__logger_8c_source_l00128}{Ant\+Log\+Async\+Msg\+::level}}, \mbox{\hyperlink{ant__logger_8c_source_l00130}{Ant\+Log\+Async\+Msg\+::message}}, \mbox{\hyperlink{ant__logger_8c_source_l00129}{Ant\+Log\+Async\+Msg\+::module}}, and \mbox{\hyperlink{types_8h_source_l00120}{Generic\+::value}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00201}{ant\+\_\+log\+\_\+write()}}.

Here is the call graph for this function\+:
% FIG 0
Here is the caller graph for this function\+:
% FIG 1
\Hypertarget{group___ant_logger_ga1f76a3ecf536cfb2681828f6b8941835}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_enable\_async@{ant\_log\_enable\_async}}
\index{ant\_log\_enable\_async@{ant\_log\_enable\_async}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_enable\_async()}{ant\_log\_enable\_async()}}
{\footnotesize\ttfamily \label{group___ant_logger_ga1f76a3ecf536cfb2681828f6b8941835} 
void ant\+\_\+log\+\_\+enable\+\_\+async (\begin{DoxyParamCaption}\item[{bool}]{enable}{}\end{DoxyParamCaption})}



Включить или отключить асинхронный режим логирования. 

Асинхронный режим (по умолчанию выключен)


\begin{DoxyParams}{Parameters}
{\em enable} & 1 -\/ включить, 0 -\/ отключить \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00069}{69}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{if}\ (enable\ \&\&\ !\mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\_async}})\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}}\ =\ \mbox{\hyperlink{async_8h_a437b5a4a2f9570b7b86d002238198b3a}{async\_event\_loop\_init}}();}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}})\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Failed\ to\ initialize\ async\ event\ loop!\(\backslash\)n"{}});}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\_async}}\ =\ 1;}
\DoxyCodeLine{00077\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!enable\ \&\&\ \mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\_async}})\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{async_8c_ae9b4f6a8a99f032aab3301f145b6f4de}{async\_event\_loop\_stop}}(\mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}});}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}}\ =\ NULL;}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\_async}}\ =\ 0;}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{async_8h_a437b5a4a2f9570b7b86d002238198b3a}{async\+\_\+event\+\_\+loop\+\_\+init()}}, \mbox{\hyperlink{async_8c_source_l00072}{async\+\_\+event\+\_\+loop\+\_\+stop()}}, \mbox{\hyperlink{ant__logger_8c_source_l00042}{log\+\_\+loop}}, and \mbox{\hyperlink{ant__logger_8c_source_l00038}{use\+\_\+async}}.

Here is the call graph for this function\+:
% FIG 2
\Hypertarget{group___ant_logger_ga221ad35833a5d41f71421f2f3c066c95}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_enable\_colors@{ant\_log\_enable\_colors}}
\index{ant\_log\_enable\_colors@{ant\_log\_enable\_colors}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_enable\_colors()}{ant\_log\_enable\_colors()}}
{\footnotesize\ttfamily \label{group___ant_logger_ga221ad35833a5d41f71421f2f3c066c95} 
void ant\+\_\+log\+\_\+enable\+\_\+colors (\begin{DoxyParamCaption}\item[{bool}]{enable}{}\end{DoxyParamCaption})}



Включить или отключить цветной вывод. 

Цветной вывод (по умолчанию включён для терминала)


\begin{DoxyParams}{Parameters}
{\em enable} & 1 -\/ включить, 0 -\/ отключить \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00063}{63}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00063\ \{\ \mbox{\hyperlink{group___ant_logger_ga7d98e2dd1964a2c9cdb897cc63f23d0b}{use\_colors}}\ =\ enable\ ?\ 1\ :\ 0;\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00034}{use\+\_\+colors}}.

\Hypertarget{group___ant_logger_ga1ab70f322f8077796d3fd3fce804d789}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_format@{ant\_log\_format}}
\index{ant\_log\_format@{ant\_log\_format}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_format()}{ant\_log\_format()}}
{\footnotesize\ttfamily \label{group___ant_logger_ga1ab70f322f8077796d3fd3fce804d789} 
static void ant\+\_\+log\+\_\+format (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{out}{, }\item[{size\+\_\+t}]{out\+\_\+sz}{, }\item[{\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}}}]{level}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{module}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{file}{, }\item[{int}]{line}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{func}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{msg}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Форматирование сообщения с цветом, временем и контекстом. 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00154}{154}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordtype}{char}\ timebuf[32];}
\DoxyCodeLine{00156\ \ \ \ \ time\_t\ now\ =\ time(NULL);}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keyword}{struct\ }tm*\ tm\_info\ =\ localtime(\&now);}
\DoxyCodeLine{00158\ \ \ \ \ strftime(timebuf,\ \textcolor{keyword}{sizeof}(timebuf),\ \textcolor{stringliteral}{"{}\%Y-\/\%m-\/\%d\ \%H:\%M:\%S"{}},\ tm\_info);}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{group___ant_logger_ga7d98e2dd1964a2c9cdb897cc63f23d0b}{use\_colors}})\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ snprintf(out,\ out\_sz,\ \textcolor{stringliteral}{"{}\%s[\%s]\ [\%s]\ [\%s]\ \%s:\%d\ (\%s):\ \%s\(\backslash\)033[0m\(\backslash\)n"{}},}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga8a2ced25981b49f1555d16f390df6006}{level\_colors}}[level],\ timebuf,\ \mbox{\hyperlink{group___ant_logger_ga6ee99f12766d97f932da55d2232f5cf5}{level\_names}}[level],\ module,\ file,\ line,\ func,\ msg);}
\DoxyCodeLine{00162\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ snprintf(out,\ out\_sz,\ \textcolor{stringliteral}{"{}[\%s]\ [\%s]\ [\%s]\ \%s:\%d\ (\%s):\ \%s\(\backslash\)n"{}},}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ timebuf,\ \mbox{\hyperlink{group___ant_logger_ga6ee99f12766d97f932da55d2232f5cf5}{level\_names}}[level],\ module,\ file,\ line,\ func,\ msg);}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00048}{level\+\_\+colors}}, \mbox{\hyperlink{ant__logger_8c_source_l00055}{level\+\_\+names}}, and \mbox{\hyperlink{ant__logger_8c_source_l00034}{use\+\_\+colors}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00201}{ant\+\_\+log\+\_\+write()}}.

Here is the caller graph for this function\+:
% FIG 3
\Hypertarget{group___ant_logger_gaa2cfe4fcc129fa9b0766b9779db64858}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_init@{ant\_log\_init}}
\index{ant\_log\_init@{ant\_log\_init}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_init()}{ant\_log\_init()}}
{\footnotesize\ttfamily \label{group___ant_logger_gaa2cfe4fcc129fa9b0766b9779db64858} 
void ant\+\_\+log\+\_\+init (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{file\+\_\+path}{}\end{DoxyParamCaption})}



Инициализация логгера. 

Инициализация логгера (опционально\+: путь к файлу, callback)


\begin{DoxyParams}{Parameters}
{\em file\+\_\+path} & Путь к файлу для логирования (NULL = stderr) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00088}{88}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{if}\ (file\_path)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}}\ =\ fopen(file\_path,\ \textcolor{stringliteral}{"{}a"{}});}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}})\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Failed\ to\ open\ log\ file\ '\%s'!\ Logging\ to\ stderr.\(\backslash\)n"{}},\ file\_path);}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}}\ =\ NULL;}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00022}{log\+\_\+file}}.

\Hypertarget{group___ant_logger_gabc00b5c23fd4d11163bb01ea559322c4}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_output@{ant\_log\_output}}
\index{ant\_log\_output@{ant\_log\_output}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_output()}{ant\_log\_output()}}
{\footnotesize\ttfamily \label{group___ant_logger_gabc00b5c23fd4d11163bb01ea559322c4} 
static void ant\+\_\+log\+\_\+output (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}}}]{level}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{module}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{msg}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Вывод сообщения (thread-\/safe) 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00136}{136}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ pthread\_mutex\_lock(\&\mbox{\hyperlink{group___ant_logger_ga54baead9ac1aa7d2d2f886956ac57c1e}{log\_mutex}});}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{group___ant_logger_gadda969f63c963605bba1b88d35ca66f6}{user\_callback}})\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_gadda969f63c963605bba1b88d35ca66f6}{user\_callback}}(level,\ module,\ msg);}
\DoxyCodeLine{00140\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}})\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ fputs(msg,\ \mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}});}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ fflush(\mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}});}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ fputs(msg,\ stderr);}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00147\ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ pthread\_mutex\_unlock(\&\mbox{\hyperlink{group___ant_logger_ga54baead9ac1aa7d2d2f886956ac57c1e}{log\_mutex}});}
\DoxyCodeLine{00149\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00022}{log\+\_\+file}}, \mbox{\hyperlink{ant__logger_8c_source_l00046}{log\+\_\+mutex}}, and \mbox{\hyperlink{ant__logger_8c_source_l00030}{user\+\_\+callback}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00174}{ant\+\_\+log\+\_\+async\+\_\+func()}}, and \mbox{\hyperlink{ant__logger_8c_source_l00201}{ant\+\_\+log\+\_\+write()}}.

Here is the caller graph for this function\+:
% FIG 4
\Hypertarget{group___ant_logger_ga9a61caaff7630aa717988962a55b3452}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_set\_callback@{ant\_log\_set\_callback}}
\index{ant\_log\_set\_callback@{ant\_log\_set\_callback}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_set\_callback()}{ant\_log\_set\_callback()}}
{\footnotesize\ttfamily \label{group___ant_logger_ga9a61caaff7630aa717988962a55b3452} 
void ant\+\_\+log\+\_\+set\+\_\+callback (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ant__logger_8h_a7bc4329f01da48b7bb263197d1d3e440}{ant\+\_\+log\+\_\+callback\+\_\+t}}}]{cb}{}\end{DoxyParamCaption})}



Установить пользовательский callback для логирования. 


\begin{DoxyParams}{Parameters}
{\em cb} & Callback-\/функция \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00121}{121}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00121\ \{\ \mbox{\hyperlink{group___ant_logger_gadda969f63c963605bba1b88d35ca66f6}{user\_callback}}\ =\ cb;\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00030}{user\+\_\+callback}}.

\Hypertarget{group___ant_logger_gabc2800dfb26fd0b291ea7e04520328ec}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_set\_level@{ant\_log\_set\_level}}
\index{ant\_log\_set\_level@{ant\_log\_set\_level}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_set\_level()}{ant\_log\_set\_level()}}
{\footnotesize\ttfamily \label{group___ant_logger_gabc2800dfb26fd0b291ea7e04520328ec} 
void ant\+\_\+log\+\_\+set\+\_\+level (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}}}]{level}{}\end{DoxyParamCaption})}



Установить минимальный уровень логирования. 

Установить минимальный уровень логирования


\begin{DoxyParams}{Parameters}
{\em level} & Минимальный уровень \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00115}{115}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00115\ \{\ \mbox{\hyperlink{group___ant_logger_gac2d0c8bd84c184f09bc7bd777bfcc96a}{min\_level}}\ =\ level;\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00026}{min\+\_\+level}}.

\Hypertarget{group___ant_logger_ga0d13b320d5c91e58632c230243f00bb8}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_shutdown@{ant\_log\_shutdown}}
\index{ant\_log\_shutdown@{ant\_log\_shutdown}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_shutdown()}{ant\_log\_shutdown()}}
{\footnotesize\ttfamily \label{group___ant_logger_ga0d13b320d5c91e58632c230243f00bb8} 
void ant\+\_\+log\+\_\+shutdown (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Завершение работы логгера, освобождение ресурсов. 

Завершение работы логгера (закрытие файлов и т.\+д.) 

Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00101}{101}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}})\ fclose(\mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}});}
\DoxyCodeLine{00103\ \ \ \ \ \mbox{\hyperlink{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}{log\_file}}\ =\ NULL;}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\_async}}\ \&\&\ \mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}})\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{async_8c_ae9b4f6a8a99f032aab3301f145b6f4de}{async\_event\_loop\_stop}}(\mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}});}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}}\ =\ NULL;}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\_async}}\ =\ 0;}
\DoxyCodeLine{00108\ \ \ \ \ \}}
\DoxyCodeLine{00109\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{async_8c_source_l00072}{async\+\_\+event\+\_\+loop\+\_\+stop()}}, \mbox{\hyperlink{ant__logger_8c_source_l00022}{log\+\_\+file}}, \mbox{\hyperlink{ant__logger_8c_source_l00042}{log\+\_\+loop}}, and \mbox{\hyperlink{ant__logger_8c_source_l00038}{use\+\_\+async}}.

Here is the call graph for this function\+:
% FIG 5
\Hypertarget{group___ant_logger_ga0aa4315bcae65fafb912aa5319c64417}\index{Логгер AntLogger@{Логгер AntLogger}!ant\_log\_write@{ant\_log\_write}}
\index{ant\_log\_write@{ant\_log\_write}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{ant\_log\_write()}{ant\_log\_write()}}
{\footnotesize\ttfamily \label{group___ant_logger_ga0aa4315bcae65fafb912aa5319c64417} 
void ant\+\_\+log\+\_\+write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}}}]{level}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{module}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{file}{, }\item[{int}]{line}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{func}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{fmt}{, }\item[{}]{...}{}\end{DoxyParamCaption})}



Основная функция логирования (используйте макросы). 

Основная функция логирования (не используйте напрямую, используйте макросы)


\begin{DoxyParams}{Parameters}
{\em level} & Уровень \\
\hline
{\em module} & Модуль \\
\hline
{\em file} & Файл \\
\hline
{\em line} & Строка \\
\hline
{\em func} & Функция \\
\hline
{\em fmt} & Формат \\
\hline
{\em ...} & Аргументы \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00201}{201}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordflow}{if}\ (level\ <\ \mbox{\hyperlink{group___ant_logger_gac2d0c8bd84c184f09bc7bd777bfcc96a}{min\_level}})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordflow}{if}\ (!module\ ||\ !file\ ||\ !func\ ||\ !fmt)\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Invalid\ log\ parameters!\(\backslash\)n"{}});}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00206\ \ \ \ \ \}}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keywordtype}{char}\ user\_msg[\mbox{\hyperlink{ant__logger_8c_ad5e3b63bac006a6db90510427d5921f4}{ANT\_LOG\_MAX\_MSG}}];}
\DoxyCodeLine{00208\ \ \ \ \ va\_list\ args;}
\DoxyCodeLine{00209\ \ \ \ \ va\_start(args,\ fmt);}
\DoxyCodeLine{00210\ \ \ \ \ vsnprintf(user\_msg,\ \textcolor{keyword}{sizeof}(user\_msg),\ fmt,\ args);}
\DoxyCodeLine{00211\ \ \ \ \ va\_end(args);}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordtype}{char}\ final\_msg[\mbox{\hyperlink{ant__logger_8c_ad5e3b63bac006a6db90510427d5921f4}{ANT\_LOG\_MAX\_MSG}}];}
\DoxyCodeLine{00214\ \ \ \ \ \mbox{\hyperlink{group___ant_logger_ga1ab70f322f8077796d3fd3fce804d789}{ant\_log\_format}}(final\_msg,\ \textcolor{keyword}{sizeof}(final\_msg),\ level,\ module,\ file,\ line,\ func,\ user\_msg);}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}{use\_async}}\ \&\&\ \mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}})\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_ant_log_async_msg}{AntLogAsyncMsg}}*\ logmsg\ =\ (\mbox{\hyperlink{struct_ant_log_async_msg}{AntLogAsyncMsg}}*)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_ant_log_async_msg}{AntLogAsyncMsg}}));}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!logmsg)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Out\ of\ memory\ for\ async\ log!\(\backslash\)n"{}});}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ logmsg-\/>\mbox{\hyperlink{struct_ant_log_async_msg_a2e56b6be26f13a2f41e8d8361961daab}{level}}\ =\ level;}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ strncpy(logmsg-\/>\mbox{\hyperlink{struct_ant_log_async_msg_af26936f11bde215bfcc526e45ced2832}{module}},\ module,\ \mbox{\hyperlink{ant__logger_8c_ac6ec193c48cb9355806642c90365dce3}{ANT\_LOG\_MAX\_MODULE}}-\/1);}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ logmsg-\/>\mbox{\hyperlink{struct_ant_log_async_msg_af26936f11bde215bfcc526e45ced2832}{module}}[\mbox{\hyperlink{ant__logger_8c_ac6ec193c48cb9355806642c90365dce3}{ANT\_LOG\_MAX\_MODULE}}-\/1]\ =\ 0;}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ strncpy(logmsg-\/>\mbox{\hyperlink{struct_ant_log_async_msg_aedf9a14773d448a9bc8762c9de4b9970}{message}},\ final\_msg,\ \mbox{\hyperlink{ant__logger_8c_ad5e3b63bac006a6db90510427d5921f4}{ANT\_LOG\_MAX\_MSG}}-\/1);}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ logmsg-\/>\mbox{\hyperlink{struct_ant_log_async_msg_aedf9a14773d448a9bc8762c9de4b9970}{message}}[\mbox{\hyperlink{ant__logger_8c_ad5e3b63bac006a6db90510427d5921f4}{ANT\_LOG\_MAX\_MSG}}-\/1]\ =\ 0;}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Подготовка\ параметров\ для\ event\ loop}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_function_params}{FunctionParams}}*\ params\ =\ (\mbox{\hyperlink{struct_function_params}{FunctionParams}}*)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_function_params}{FunctionParams}}));}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!params)\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Out\ of\ memory\ for\ async\ params!\(\backslash\)n"{}});}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ free(logmsg);}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ params-\/>\mbox{\hyperlink{struct_function_params_abec2b9a3d56da4074bd803c48dadba8e}{argc}}\ =\ 1;}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}}\ =\ (\mbox{\hyperlink{struct_generic}{Generic}}*)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_generic}{Generic}}));}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}})\ \{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Out\ of\ memory\ for\ async\ argv!\(\backslash\)n"{}});}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ free(logmsg);}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ free(params);}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}}[0].\mbox{\hyperlink{struct_generic_a1fbf56fa903c54bf08b9be9d7a11138e}{value}}\ =\ logmsg;}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}}[0].\mbox{\hyperlink{struct_generic_a031d63fc3caf0870abc151457255d7e2}{type}}\ =\ \mbox{\hyperlink{types_8h_a5b49a4735004213d537a8915a2ac69a0a497144f2c25c5ca1c40241a9bbf6f27a}{GENERIC\_TYPE\_PTR}};}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_function_pipeline}{FunctionPipeline}}*\ fp\ =\ (\mbox{\hyperlink{struct_function_pipeline}{FunctionPipeline}}*)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_function_pipeline}{FunctionPipeline}}));}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!fp)\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}[ant\_logger]\ ERROR:\ Out\ of\ memory\ for\ async\ pipeline!\(\backslash\)n"{}});}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ free(logmsg);}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ free(params-\/>\mbox{\hyperlink{struct_function_params_aa928a3634843ca5a3e5469b97efb4787}{argv}});}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ free(params);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ fp-\/>\mbox{\hyperlink{struct_function_pipeline_aff8419f3b667770db719552b8cad63b2}{func}}\ =\ \mbox{\hyperlink{group___ant_logger_ga88512267049455a44ecba369aa21dfa4}{ant\_log\_async\_func}};}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ fp-\/>\mbox{\hyperlink{struct_function_pipeline_a33af58396e5a6d72bc1e86bfe624f659}{next}}\ =\ NULL;}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{async_8c_a07b659d1096ebc8c902a9a5e63ad4925}{async\_run}}(\mbox{\hyperlink{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}{log\_loop}},\ fp,\ params);}
\DoxyCodeLine{00255\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___ant_logger_gabc00b5c23fd4d11163bb01ea559322c4}{ant\_log\_output}}(level,\ module,\ final\_msg);}
\DoxyCodeLine{00257\ \ \ \ \ \}}
\DoxyCodeLine{00258\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{ant__logger_8c_source_l00174}{ant\+\_\+log\+\_\+async\+\_\+func()}}, \mbox{\hyperlink{ant__logger_8c_source_l00154}{ant\+\_\+log\+\_\+format()}}, \mbox{\hyperlink{ant__logger_8c_source_l00011}{ANT\+\_\+\+LOG\+\_\+\+MAX\+\_\+\+MODULE}}, \mbox{\hyperlink{ant__logger_8c_source_l00010}{ANT\+\_\+\+LOG\+\_\+\+MAX\+\_\+\+MSG}}, \mbox{\hyperlink{ant__logger_8c_source_l00136}{ant\+\_\+log\+\_\+output()}}, \mbox{\hyperlink{types_8h_source_l00210}{Function\+Params\+::argc}}, \mbox{\hyperlink{types_8h_source_l00211}{Function\+Params\+::argv}}, \mbox{\hyperlink{async_8c_source_l00101}{async\+\_\+run()}}, \mbox{\hyperlink{types_8h_source_l00222}{Function\+Pipeline\+::func}}, \mbox{\hyperlink{types_8h_source_l00073}{GENERIC\+\_\+\+TYPE\+\_\+\+PTR}}, \mbox{\hyperlink{ant__logger_8c_source_l00128}{Ant\+Log\+Async\+Msg\+::level}}, \mbox{\hyperlink{ant__logger_8c_source_l00042}{log\+\_\+loop}}, \mbox{\hyperlink{ant__logger_8c_source_l00130}{Ant\+Log\+Async\+Msg\+::message}}, \mbox{\hyperlink{ant__logger_8c_source_l00026}{min\+\_\+level}}, \mbox{\hyperlink{ant__logger_8c_source_l00129}{Ant\+Log\+Async\+Msg\+::module}}, \mbox{\hyperlink{types_8h_source_l00223}{Function\+Pipeline\+::next}}, \mbox{\hyperlink{types_8h_source_l00121}{Generic\+::type}}, \mbox{\hyperlink{ant__logger_8c_source_l00038}{use\+\_\+async}}, and \mbox{\hyperlink{types_8h_source_l00120}{Generic\+::value}}.

Here is the call graph for this function\+:
% FIG 6


\doxysubsection{Variable Documentation}
\Hypertarget{group___ant_logger_ga8a2ced25981b49f1555d16f390df6006}\index{Логгер AntLogger@{Логгер AntLogger}!level\_colors@{level\_colors}}
\index{level\_colors@{level\_colors}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{level\_colors}{level\_colors}}
{\footnotesize\ttfamily \label{group___ant_logger_ga8a2ced25981b49f1555d16f390df6006} 
const char\texorpdfstring{$\ast$}{*} level\+\_\+colors\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;37m"{}},\ }
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;32m"{}},\ }
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[1;33m"{}},\ }
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;31m"{}},\ }
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[1;41m"{}}\ \ }
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00048}{48}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;37m"{}},\ \textcolor{comment}{//\ DEBUG\ -\/\ white}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;32m"{}},\ \textcolor{comment}{//\ INFO\ -\/\ green}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[1;33m"{}},\ \textcolor{comment}{//\ WARNING\ -\/\ yellow}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[0;31m"{}},\ \textcolor{comment}{//\ ERROR\ -\/\ red}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)033[1;41m"{}}\ \ \textcolor{comment}{//\ FATAL\ -\/\ red\ bg}}
\DoxyCodeLine{00054\ \};}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00154}{ant\+\_\+log\+\_\+format()}}.

\Hypertarget{group___ant_logger_ga6ee99f12766d97f932da55d2232f5cf5}\index{Логгер AntLogger@{Логгер AntLogger}!level\_names@{level\_names}}
\index{level\_names@{level\_names}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{level\_names}{level\_names}}
{\footnotesize\ttfamily \label{group___ant_logger_ga6ee99f12766d97f932da55d2232f5cf5} 
const char\texorpdfstring{$\ast$}{*} level\+\_\+names\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{stringliteral}{"{}DEBUG"{}},\ \textcolor{stringliteral}{"{}INFO"{}},\ \textcolor{stringliteral}{"{}WARNING"{}},\ \textcolor{stringliteral}{"{}ERROR"{}},\ \textcolor{stringliteral}{"{}FATAL"{}}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00055}{55}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{stringliteral}{"{}DEBUG"{}},\ \textcolor{stringliteral}{"{}INFO"{}},\ \textcolor{stringliteral}{"{}WARNING"{}},\ \textcolor{stringliteral}{"{}ERROR"{}},\ \textcolor{stringliteral}{"{}FATAL"{}}}
\DoxyCodeLine{00057\ \};}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00154}{ant\+\_\+log\+\_\+format()}}.

\Hypertarget{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36}\index{Логгер AntLogger@{Логгер AntLogger}!log\_file@{log\_file}}
\index{log\_file@{log\_file}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{log\_file}{log\_file}}
{\footnotesize\ttfamily \label{group___ant_logger_gab936051f5aaca44c6c3c41dee0d19c36} 
FILE\texorpdfstring{$\ast$}{*} log\+\_\+file = NULL\hspace{0.3cm}{\ttfamily [static]}}



Файл для логирования (NULL = stderr) 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00022}{22}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00088}{ant\+\_\+log\+\_\+init()}}, \mbox{\hyperlink{ant__logger_8c_source_l00136}{ant\+\_\+log\+\_\+output()}}, and \mbox{\hyperlink{ant__logger_8c_source_l00101}{ant\+\_\+log\+\_\+shutdown()}}.

\Hypertarget{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8}\index{Логгер AntLogger@{Логгер AntLogger}!log\_loop@{log\_loop}}
\index{log\_loop@{log\_loop}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{log\_loop}{log\_loop}}
{\footnotesize\ttfamily \label{group___ant_logger_ga3c6cd94cdc21d8d73efb8623b97da4d8} 
\mbox{\hyperlink{struct_async_event_loop}{Async\+Event\+Loop}}\texorpdfstring{$\ast$}{*} log\+\_\+loop = NULL\hspace{0.3cm}{\ttfamily [static]}}



Event loop для асинхронного логирования 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00042}{42}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00069}{ant\+\_\+log\+\_\+enable\+\_\+async()}}, \mbox{\hyperlink{ant__logger_8c_source_l00101}{ant\+\_\+log\+\_\+shutdown()}}, and \mbox{\hyperlink{ant__logger_8c_source_l00201}{ant\+\_\+log\+\_\+write()}}.

\Hypertarget{group___ant_logger_ga54baead9ac1aa7d2d2f886956ac57c1e}\index{Логгер AntLogger@{Логгер AntLogger}!log\_mutex@{log\_mutex}}
\index{log\_mutex@{log\_mutex}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{log\_mutex}{log\_mutex}}
{\footnotesize\ttfamily \label{group___ant_logger_ga54baead9ac1aa7d2d2f886956ac57c1e} 
pthread\+\_\+mutex\+\_\+t log\+\_\+mutex = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER\hspace{0.3cm}{\ttfamily [static]}}



Мьютекс для потокобезопасности 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00046}{46}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00136}{ant\+\_\+log\+\_\+output()}}.

\Hypertarget{group___ant_logger_gac2d0c8bd84c184f09bc7bd777bfcc96a}\index{Логгер AntLogger@{Логгер AntLogger}!min\_level@{min\_level}}
\index{min\_level@{min\_level}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{min\_level}{min\_level}}
{\footnotesize\ttfamily \label{group___ant_logger_gac2d0c8bd84c184f09bc7bd777bfcc96a} 
\mbox{\hyperlink{ant__logger_8h_a3555fa16857447d43ca763e0b54a1eaa}{ant\+\_\+log\+\_\+level\+\_\+t}} min\+\_\+level = \mbox{\hyperlink{ant__logger_8h_a2b59d76f88b5231b3ac08e423a952b86}{ANT\+\_\+\+LOG\+\_\+\+DEBUG}}\hspace{0.3cm}{\ttfamily [static]}}



Минимальный уровень логирования 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00026}{26}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00115}{ant\+\_\+log\+\_\+set\+\_\+level()}}, and \mbox{\hyperlink{ant__logger_8c_source_l00201}{ant\+\_\+log\+\_\+write()}}.

\Hypertarget{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee}\index{Логгер AntLogger@{Логгер AntLogger}!use\_async@{use\_async}}
\index{use\_async@{use\_async}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{use\_async}{use\_async}}
{\footnotesize\ttfamily \label{group___ant_logger_ga0e9196e140d1096d301f320d049c12ee} 
int use\+\_\+async = 0\hspace{0.3cm}{\ttfamily [static]}}



Включён ли асинхронный режим 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00038}{38}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00069}{ant\+\_\+log\+\_\+enable\+\_\+async()}}, \mbox{\hyperlink{ant__logger_8c_source_l00101}{ant\+\_\+log\+\_\+shutdown()}}, and \mbox{\hyperlink{ant__logger_8c_source_l00201}{ant\+\_\+log\+\_\+write()}}.

\Hypertarget{group___ant_logger_ga7d98e2dd1964a2c9cdb897cc63f23d0b}\index{Логгер AntLogger@{Логгер AntLogger}!use\_colors@{use\_colors}}
\index{use\_colors@{use\_colors}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{use\_colors}{use\_colors}}
{\footnotesize\ttfamily \label{group___ant_logger_ga7d98e2dd1964a2c9cdb897cc63f23d0b} 
int use\+\_\+colors = 1\hspace{0.3cm}{\ttfamily [static]}}



Включён ли цветной вывод 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00034}{34}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00063}{ant\+\_\+log\+\_\+enable\+\_\+colors()}}, and \mbox{\hyperlink{ant__logger_8c_source_l00154}{ant\+\_\+log\+\_\+format()}}.

\Hypertarget{group___ant_logger_gadda969f63c963605bba1b88d35ca66f6}\index{Логгер AntLogger@{Логгер AntLogger}!user\_callback@{user\_callback}}
\index{user\_callback@{user\_callback}!Логгер AntLogger@{Логгер AntLogger}}
\doxysubsubsection{\texorpdfstring{user\_callback}{user\_callback}}
{\footnotesize\ttfamily \label{group___ant_logger_gadda969f63c963605bba1b88d35ca66f6} 
\mbox{\hyperlink{ant__logger_8h_a7bc4329f01da48b7bb263197d1d3e440}{ant\+\_\+log\+\_\+callback\+\_\+t}} user\+\_\+callback = NULL\hspace{0.3cm}{\ttfamily [static]}}



Пользовательский callback для логирования 



Definition at line \mbox{\hyperlink{ant__logger_8c_source_l00030}{30}} of file \mbox{\hyperlink{ant__logger_8c_source}{ant\+\_\+logger.\+c}}.



Referenced by \mbox{\hyperlink{ant__logger_8c_source_l00136}{ant\+\_\+log\+\_\+output()}}, and \mbox{\hyperlink{ant__logger_8c_source_l00121}{ant\+\_\+log\+\_\+set\+\_\+callback()}}.

